<div class='flex flex-col space-y-4 items-center'>
  <div>
    <%= link_to_unless_current @insta_user.at_username, insta_user_path(@insta_user) %>
  </div>

  <%= form_with url: insta_user_posts_path(@insta_user),
                method: :get,
                data: { controller: 'debounce',
                        debounce_target: 'form',
                        turbo_frame: 'results' } do |form| %>
    <%= form.text_field :caption,
                        placeholder: 'Find a post',
                        value: params[:caption],
                        autocomplete: 'off',
                        autofocus: true,
                        class: 'rounded-md border border-slate-300',
                        data: { action: 'input->debounce#search' } %>
  <% end %>

  <% if cookies[:view].eql?('grid') %>
    <%= link_to insta_user_posts_path(@insta_user, view: :list) do %>
      List
    <% end %>
  <% elsif cookies[:view].eql?('list') %>
    <%= link_to insta_user_posts_path(@insta_user, view: :grid) do %>
      Grid
    <% end %>
  <% end %>

  <%= turbo_frame_tag 'results', target: '_top', data: { turbo_action: 'advance' } do %>
    <%#= request.url %>
    <%#= link_to 'Clear search', request.path if request.query_parameters.any? %>
    <% if cookies[:view].eql?('grid') %>
      <%= render partial: 'insta_posts/grid_view', locals: { posts: @posts } %>
    <% elsif cookies[:view].eql?('list') %>
      <%= render partial: 'insta_posts/list_view', locals: { posts: @posts } %>
    <% end %>
  <% end %>
</div>
